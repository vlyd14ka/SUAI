<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тренера</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
    <style>
        /* Ваши стили */
        .coach-card {
            background-color: #222;
            color: white;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            height: 450px; /* Увеличиваем высоту карточки для большего пространства */
            overflow: hidden; /* Скрываем лишнее */
        }
    
        .coach-card img {
            width: 100%;
            height: 200px; /* Высота изображения */
            object-fit: cover; /* Заполнение контейнера без искажения пропорций */
            border-bottom: 2px solid #FF4500;
        }
    
        .coach-card h3 {
            margin: 10px;
            text-align: center;
            font-size: 20px; /* Уменьшаем размер шрифта для заголовка */
        }
    
        .coach-card p {
            padding: 10px;
            font-size: 14px; /* Уменьшаем размер шрифта */
            height: 120px; /* Уменьшаем высоту блока с текстом */
            overflow: hidden;
            flex-grow: 1; /* Разрешаем тексту занимать больше места, если оно доступно */
            text-overflow: ellipsis; /* Обрезка текста с многоточием в конце */
        }
    
        .btn-book {
            background-color: #FF4500;
            color: white;
            border: none;
            width: 100%;
            padding: 10px;
            cursor: pointer;
            font-size: 16px;
        }
    
        .btn-book:hover {
            background-color: #FF0000;
        }
    
        .form-container {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-top: 40px;
        }
    
        .form-group {
            margin-top: 20px;
        }
    
        .btn-register {
            background-color: #FF4500;
            color: white;
            width: 100%;
            padding: 10px;
            border: none;
            cursor: pointer;
            margin-top: 20px;
        }
    
        .btn-register:hover {
            background-color: #FF0000;
        }
    
        .container {
            margin-top: 40px;
        }
        .form-container h4 {
            color: black;
        }
    </style>
</head>
<body>

    <!-- Навигация -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">Спортивный клуб</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Переключить навигацию">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Главная</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="trainings.html">Тренировки</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="coaches.html">Тренера</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="membership.html">Абонементы</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="shop.html">Магазин</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="reviews.html">Отзывы</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="rental.html">Аренда залов и дополнительные услуги</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="profile.html">Профиль</a>
                    </li>

                </ul>
            </div>
        </div>
    </nav>
    <button id="roleToggleBtn" class="btn btn-secondary mb-3">Сменить роль</button>
    <div class="container">
        <h2>Наши тренеры</h2>

        <div class="row">
            <!-- Карточка тренера 1 -->
            <div class="col-md-4">
                <div class="coach-card">
                    <img src="img/trener_plovets.jpg" alt="Тренер 1">
                    <h3>Иван Иванов</h3>
                    <p>Мастер спорта по плаванию, победитель чемпионатов России. Преподает плавание более 10 лет. Дает как групповые, так и индивидуальные занятия. Особое внимание уделяет технике и физической подготовке.</p>
                    <a href="#booking-form" class="btn-book">Записаться на индивидуальные занятия</a>
                    <a href="#" class="showTrainingsBtn btn-book" data-bs-toggle="modal" data-bs-target="#trainingModal" data-coach="ivan ivanov" style="display:none;">Посмотреть тренировки</a>
                </div>
            </div>
            <!-- Карточка тренера 2 -->
            <div class="col-md-4">
                <div class="coach-card">
                    <img src="img/trener_yoga.jpg" alt="Тренер 2">
                    <h3>Елена Смирнова</h3>
                    <p>Профессиональная тренер по йоге с 15-летним стажем. Преподавала в Индии и Таиланде. Вдохновляет на занятия йогой людей всех возрастов, помогает достигать внутренней гармонии.</p>
                    <a href="#booking-form" class="btn-book">Записаться на индивидуальные занятия</a>
                    <a href="#" class="showTrainingsBtn btn-book" data-bs-toggle="modal" data-bs-target="#trainingModal" data-coach="elena smirnova" style="display:none;">Посмотреть тренировки</a>
                </div>
            </div>
            <!-- Карточка тренера 3 -->
            <div class="col-md-4">
                <div class="coach-card">
                    <img src="img/trener_silovye.jpg" alt="Тренер 3">
                    <h3>Сергей Кузнецов</h3>
                    <p>Чемпион России по силовым упражнениям. С 8 лет тренирует людей, добиваясь отличных результатов в увеличении силы и выносливости. Специалист по функциональным тренировкам.</p>
                    <a href="#booking-form" class="btn-book">Записаться на индивидуальные занятия</a>
                    <a href="#" class="showTrainingsBtn btn-book" data-bs-toggle="modal" data-bs-target="#trainingModal" data-coach="sergey kuznetsov" style="display:none;">Посмотреть тренировки</a>
                </div>
            </div>
            <!-- Карточка тренера 4 -->
            <div class="col-md-4">
                <div class="coach-card">
                    <img src="img/trener_fitnes.jpg" alt="Тренер 4">
                    <h3>Анна Петрова</h3>
                    <p>Тренер по фитнесу с более чем 10-летним стажем. Победительница множества международных соревнований по аэробике. Преподает кардио и фитнес-тренировки, работает с людьми любого уровня подготовки.</p>
                    <a href="#booking-form" class="btn-book">Записаться на индивидуальные занятия</a>
                    <a href="#" class="showTrainingsBtn btn-book" data-bs-toggle="modal" data-bs-target="#trainingModal" data-coach="anna petrova" style="display:none;">Посмотреть тренировки</a>
                </div>
            </div>
            <!-- Карточка тренера 5 -->
            <div class="col-md-4">
                <div class="coach-card">
                    <img src="img/trener_funktsional.jpg" alt="Тренер 5">
                    <h3>Ольга Воронцова</h3>
                    <p>Мастерица по функциональным тренировкам, разработчик уникальной методики тренировок для восстановления после травм. Прошла обучение у ведущих специалистов США и Европы.</p>
                    <a href="#booking-form" class="btn-book">Записаться на индивидуальные занятия</a>
                    <a href="#" class="showTrainingsBtn btn-book" data-bs-toggle="modal" data-bs-target="#trainingModal" data-coach="olga vorontsova" style="display:none;">Посмотреть тренировки</a>
                </div>
            </div>
            <!-- Карточка тренера 6 -->
            <div class="col-md-4">
                <div class="coach-card">
                    <img src="img/trener_kardio.jpeg" alt="Тренер 6">
                    <h3>Марина Сидорова</h3>
                    <p>Профессиональный тренер по кардио и пилатесу. Победительница международных соревнований. Составляет персональные тренировки для достижения максимальных результатов и восстановления после родов.</p>
                    <a href="#booking-form" class="btn-book">Записаться на индивидуальные занятия</a>
                    <a href="#" class="showTrainingsBtn btn-book" data-bs-toggle="modal" data-bs-target="#trainingModal" data-coach="marina sidorova" style="display:none;">Посмотреть тренировки</a>
                </div>
            </div>
        </div>
        
<!-- Модальное окно для тренировки -->
<div class="modal fade" id="trainingModal" tabindex="-1" aria-labelledby="trainingModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="trainingModalLabel">Расписание тренировок</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Закрыть"></button>
            </div>
            <div class="modal-body">
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Дата</th>
                            <th>Время</th>
                            <th>Тренер</th>
                        </tr>
                    </thead>
                    <tbody id="trainingList">
                        <!-- Сюда будет добавляться список тренировок -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

        <!-- Форма для записи на индивидуальные занятия -->
        <div class="form-container" id="booking-form">
            <h4>Записаться на индивидуальное занятие</h4>
            <form action="/submit_booking" method="POST">
                <div class="form-group">
                    <label for="fullName">Ф.И.О.</label>
                    <input type="text" class="form-control" id="fullName" name="fullName" placeholder="Введите ваше имя" required>
                </div>

                <div class="form-group">
                    <label for="phone">Номер телефона</label>
                    <input type="tel" class="form-control" id="phone" name="phone" placeholder="Введите ваш номер телефона" required>
                </div>

                <div class="form-group">
                    <label for="coach">Выберите тренера</label>
                    <select class="form-control" id="coach" name="coach" required>
                        <option value="ivan ivanov">Иван Иванов</option>
                        <option value="elena smirnova">Елена Смирнова</option>
                        <option value="sergey kuznetsov">Сергей Кузнецов</option>
                        <option value="anna petrova">Анна Петрова</option>
                        <option value="olga vorontsova ">Ольга Воронцова</option>
                        <option value="marina sidorova">Марина Сидорова</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="date">Дата занятия</label>
                    <input type="date" class="form-control" id="date" name="date" required>
                </div>

                <div class="form-group">
                    <label for="time">Время занятия</label>
                    <select class="form-control" id="time" name="time" required></select>
                </div>

                <button type="submit" class="btn-register">Записаться</button>
            </form>
        </div>
    </div>

    <script>
        // Заполнение времени с интервалом 30 минут с 10:00 до 21:30
        const timeSelect = document.getElementById('time');
        const startTime = 10; // Начало времени (10:00)
        const endTime = 21; // Конец времени (21:30)

        // Функция для форматирования времени (например, 10:00 вместо 10:0)
        function formatTime(hour, minute) {
            const h = hour < 10 ? '0' + hour : hour;
            const m = minute < 10 ? '0' + minute : minute;
            return `${h}:${m}`;
        }

        // Генерация времени с интервалом 30 минут
        for (let hour = startTime; hour <= endTime; hour++) {
            timeSelect.innerHTML += `<option value="${formatTime(hour, 0)}">${formatTime(hour, 0)}</option>`;
            timeSelect.innerHTML += `<option value="${formatTime(hour, 30)}">${formatTime(hour, 30)}</option>`;
        }

        // Обработка отправки формы
// Обработчик отправки формы
document.getElementById('booking-form').addEventListener('submit', function (e) {
    e.preventDefault(); // Останавливаем стандартное поведение формы (перезагрузку)

    const form = e.target; // Получаем саму форму
    const formData = new FormData(form); // Создаем объект FormData из формы

    const data = {
        fullName: formData.get('fullName'),
        phone: formData.get('phone'),
        coach: formData.get('coach'),
        date: formData.get('date'),
        time: formData.get('time')
    };

    fetch('http://localhost:3000/submit_booking', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    })
    .then(response => response.text())
    .then(data => {
        alert(data); // Показываем сообщение от сервера
    })
    .catch(error => {
        console.error('Ошибка:', error);
        alert('Произошла ошибка при записи на занятие');
    });
});

// Функция для форматирования времени в AM/PM
function formatTimeAMPM(time) {
    const [hours, minutes] = time.split(':');
    const hour = parseInt(hours);
    const period = hour >= 12 ? 'PM' : 'AM';
    const formattedHour = hour > 12 ? hour - 12 : hour;
    const formattedMinutes = minutes ? (minutes.length === 1 ? `0${minutes}` : minutes) : '00';
    return `${formattedHour}:${formattedMinutes} ${period}`;
}

// Функция для обновления списка тренировок из базы данных
function updateTrainingList(coach) {
    const trainingList = document.getElementById('trainingList');
    trainingList.innerHTML = ''; // Очистить список

    // Отправляем запрос на сервер для получения тренировок
    fetch(`/trainings/${coach}`)
        .then(response => response.json())
        .then(trainings => {
            if (trainings.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="3">Тренировки не найдены</td>`;
                trainingList.appendChild(row);
            } else {
                trainings.forEach(training => {
                    const row = document.createElement('tr');
                    const trainingDate = new Date(training.training_date);
                    const localDate = trainingDate.toLocaleDateString('ru-RU'); // Локальная дата

                    row.innerHTML = `
                        <td>${localDate}</td>
                        <td>${formatTimeAMPM(training.training_time)}</td> <!-- Преобразуем время в AM/PM формат -->
                        <td>${training.coach}</td>
                    `;
                    trainingList.appendChild(row);
                });
            }
        })
        .catch(error => {
            const row = document.createElement('tr');
            row.innerHTML = `<td colspan="3">Ошибка загрузки данных</td>`;
            trainingList.appendChild(row);
        });
}


// Добавляем обработчик для кнопки "Посмотреть тренировки"
const trainingButtons = document.querySelectorAll('.btn-book');
trainingButtons.forEach(button => {
    button.addEventListener('click', () => {
        const coach = button.getAttribute('data-coach');
        updateTrainingList(coach);
    });
});

let currentRole = 'user'; // Начальная роль пользователя

// Переключение ролей
document.getElementById('roleToggleBtn').addEventListener('click', function() {
    // Переключаем между ролями
    if (currentRole === 'user') {
        currentRole = 'trainer';
        alert('Вы вошли как тренер');
    } else {
        currentRole = 'user';
        alert('Вы вошли как пользователь');
    }
    
    toggleRoleFeatures(); // Обновляем видимость кнопок
});

// Управление доступом к кнопкам "Посмотреть тренировки"
function toggleRoleFeatures() {
    const showTrainingsBtns = document.querySelectorAll('.showTrainingsBtn');
    
    // Показываем кнопки "Посмотреть тренировки" только для тренеров
    showTrainingsBtns.forEach(function(btn) {
        if (currentRole === 'trainer') {
            btn.style.display = 'block';
        } else {
            btn.style.display = 'none';
        }
    });
}


// Пример обработки модального окна
document.querySelector('.btn-book').addEventListener('click', function(event) {
    const coach = event.target.getAttribute('data-coach');
    console.log('Тренер:', coach); // Выводим имя тренера, можно передать в модальное окно
});

    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
